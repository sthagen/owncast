"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5861],{20250:function(e,t,n){n.d(t,{e:function(){return BanUserButton}});var s=n(85893),a=n(56697),l=n(65400),r=n(5152),o=n.n(r),d=n(3111);let i=o()(()=>Promise.resolve().then(n.t.bind(n,42461,23)),{loadableGenerated:{webpack:()=>[42461]},ssr:!1}),c=o()(()=>n.e(1538).then(n.t.bind(n,11538,23)),{loadableGenerated:{webpack:()=>[11538]},ssr:!1}),u=o()(()=>n.e(6773).then(n.t.bind(n,6773,23)),{loadableGenerated:{webpack:()=>[6773]},ssr:!1}),BanUserButton=e=>{let{user:t,isEnabled:n,label:r,onClick:o}=e;async function buttonClicked(e){let{id:t}=e;try{let e=await (0,d.rQ)(d.NM,{data:{userId:t,enabled:!n},method:"POST",auth:!0});return e.success}catch(e){console.error(e)}return!1}let h=n?"ban":"unban",m=n?(0,s.jsx)(i,{style:{color:"var(--ant-error)"}}):(0,s.jsx)(c,{style:{color:"var(--ant-warning)"}}),b=(0,s.jsxs)(s.Fragment,{children:["Are you sure you want to ",h," ",(0,s.jsx)("strong",{children:t.displayName}),n?" and remove their messages?":"?"]});return(0,s.jsx)(l.default,{type:"primary",onClick:()=>{a.default.confirm({title:"Confirm ".concat(h),content:b,onCancel:()=>{},onOk:()=>new Promise((e,n)=>{let s=buttonClicked(t);s?setTimeout(()=>{e(s),null==o||o()},3e3):n()}),okType:"danger",okText:n?"Absolutely":null,icon:m})},size:"small",icon:n?(0,s.jsx)(u,{twoToneColor:"#ff4d4f"}):null,className:"block-user-button",children:r||h})};BanUserButton.defaultProps={label:"",onClick:null}},60708:function(e,t,n){n.d(t,{Z:function(){return UserPopover}});var s=n(85893),a=n(67294),l=n(74253),r=n(56697),o=n(53740),d=n(55673),i=n(5789),c=n(74048),u=n(94055),h=n(45938),m=n(58091),b=n(44908),x=n.n(b),j=n(20250),p=n(65400),f=n(5152),y=n.n(f),k=n(3111);let w=y()(()=>Promise.resolve().then(n.t.bind(n,42461,23)),{loadableGenerated:{webpack:()=>[42461]},ssr:!1}),C=y()(()=>n.e(1538).then(n.t.bind(n,11538,23)),{loadableGenerated:{webpack:()=>[11538]},ssr:!1}),g=y()(()=>n.e(6773).then(n.t.bind(n,6773,23)),{loadableGenerated:{webpack:()=>[6773]},ssr:!1}),v=y()(()=>n.e(4612).then(n.t.bind(n,64612,23)),{loadableGenerated:{webpack:()=>[64612]},ssr:!1}),ModeratorUserButton=e=>{var t;let{user:n,onClick:a}=e;async function buttonClicked(e,t){let{id:n}=e;try{let e=await (0,k.rQ)(k.jr,{data:{userId:n,isModerator:t},method:"POST",auth:!0});return e.success}catch(e){console.error(e)}return!1}let l=null===(t=n.scopes)||void 0===t?void 0:t.includes("MODERATOR"),o=l?"remove moderator":"add moderator",d=l?(0,s.jsx)(w,{style:{color:"var(--ant-error)"}}):(0,s.jsx)(C,{style:{color:"var(--ant-warning)"}}),i=(0,s.jsxs)(s.Fragment,{children:["Are you sure you want to ",o," ",(0,s.jsx)("strong",{children:n.displayName}),"?"]});return(0,s.jsx)(p.default,{type:"primary",onClick:()=>{r.default.confirm({title:"Confirm ".concat(o),content:i,onCancel:()=>{},onOk:()=>new Promise((e,t)=>{let s=buttonClicked(n,!l);s?setTimeout(()=>{e(s),null==a||a()},3e3):t()}),okType:"danger",okText:l?"Yup!":null,icon:d})},size:"small",icon:l?(0,s.jsx)(g,{twoToneColor:"#ff4d4f"}):(0,s.jsx)(v,{twoToneColor:"#22bb44"}),className:"block-user-button",children:o})};ModeratorUserButton.defaultProps={onClick:null};var D=n(15851),T=n(21119);let UserPopover=e=>{let{user:t,connectionInfo:n,children:b}=e,[p,f]=(0,a.useState)(!1),handleCloseModal=()=>{f(!1)},{displayName:y,createdAt:k,previousNames:w,nameChangedAt:C,disabledAt:g}=t,{connectedAt:v,messageCount:N,userAgent:M}=n||{},A=null,P=w&&[...w];w&&w.length>1&&C&&(A=new Date(C),P.reverse());let U=new Date(k),B=(0,m.Z)(U,"PP pp"),Z=A?(0,h.Z)(A):null;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.default,{title:(0,s.jsxs)(s.Fragment,{children:["Created at: ",B,".",(0,s.jsx)("br",{})," Click for more info."]}),placement:"bottomLeft",children:(0,s.jsx)("button",{type:"button","aria-label":"Display more details about this user",className:"user-item-container",onClick:()=>{f(!0)},children:b})}),(0,s.jsx)(r.default,{destroyOnClose:!0,width:600,cancelText:"Close",okButtonProps:{style:{display:"none"}},title:"User details: ".concat(y),open:p,onOk:handleCloseModal,onCancel:handleCloseModal,children:(0,s.jsxs)("div",{className:"user-details",children:[(0,s.jsx)(o.default.Title,{level:4,children:y}),(0,s.jsxs)("p",{className:"created-at",children:["User created at ",B,"."]}),(0,s.jsxs)(d.Z,{gutter:16,children:[n&&(0,s.jsxs)(i.Z,{md:A?12:24,children:[(0,s.jsx)(o.default.Title,{level:5,children:"This user is currently connected to Chat."}),(0,s.jsxs)("ul",{className:"connection-info",children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Active for:"})," ",(0,h.Z)(new Date(v))]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Messages sent:"})," ",N]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"User Agent:"}),(0,s.jsx)("br",{}),(0,T.AB)(M)]})]})]}),A&&(0,s.jsxs)(i.Z,{md:n?12:24,children:[(0,s.jsx)(o.default.Title,{level:5,children:"This user is also seen as:"}),(0,s.jsx)("ul",{className:"previous-names-list",children:x()(P).map((e,t)=>(0,s.jsxs)("li",{className:0===t?"latest":"",children:[(0,s.jsx)("span",{className:"user-name-item",children:e}),0===t?" (Changed ".concat(Z," ago)"):""]}))})]})]}),(0,s.jsx)(l.Z,{}),(0,s.jsxs)(c.default,{direction:"horizontal",children:[g?(0,s.jsxs)(s.Fragment,{children:["This user was banned on ",(0,s.jsx)("code",{children:(0,D.u)(g)}),".",(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(j.e,{label:"Unban this user",user:t,isEnabled:!1,onClick:handleCloseModal})]}):(0,s.jsx)(j.e,{label:"Ban this user",user:t,isEnabled:!0,onClick:handleCloseModal}),(0,s.jsx)(ModeratorUserButton,{user:t,onClick:handleCloseModal})]})]})})]})};UserPopover.defaultProps={connectionInfo:null}},15851:function(e,t,n){n.d(t,{K:function(){return UserTable},u:function(){return formatDisplayDate}});var s=n(85893),a=n(2307),l=n(58091),r=n(60708),o=n(20250);function formatDisplayDate(e){let t=new Date(e);return t.getFullYear()!==new Date().getFullYear()?(0,l.Z)(new Date(e),"MMM d, yyyy H:mma"):(0,l.Z)(new Date(e),"MMM d H:mma")}let UserTable=e=>{let{data:t}=e,n=[{title:"Last Known Display Name",dataIndex:"displayName",key:"displayName",render:(e,t)=>(0,s.jsx)(r.Z,{user:t,children:(0,s.jsx)("span",{className:"display-name",children:e})})},{title:"Created",dataIndex:"createdAt",key:"createdAt",render:e=>formatDisplayDate(e),sorter:(e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime(),sortDirections:["descend","ascend"]},{title:"Disabled at",dataIndex:"disabledAt",key:"disabledAt",defaultSortOrder:"descend",render:e=>e?formatDisplayDate(e):null,sorter:(e,t)=>new Date(e.disabledAt).getTime()-new Date(t.disabledAt).getTime(),sortDirections:["descend","ascend"]},{title:"",key:"block",className:"actions-col",render:(e,t)=>(0,s.jsx)(o.e,{user:t,isEnabled:!t.disabledAt})}];return(0,s.jsx)(a.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:n,dataSource:t,size:"small",rowKey:"id"})}}}]);