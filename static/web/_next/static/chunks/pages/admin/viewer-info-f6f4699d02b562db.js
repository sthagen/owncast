(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6109],{25378:function(e,t,r){"use strict";var n=r(67294),a=r(57838),s=r(24308);t.Z=function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,n.useRef)({}),r=(0,a.Z)();return(0,n.useEffect)(function(){var n=s.ZP.subscribe(function(n){t.current=n,e&&r()});return function(){return s.ZP.unsubscribe(n)}},[]),t.current}},77349:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(83946),a=r(19013),s=r(13882);function i(e,t){(0,s.Z)(2,arguments);var r=(0,a.Z)(e),i=(0,n.Z)(t);return isNaN(i)?new Date(NaN):(i&&r.setDate(r.getDate()+i),r)}},11640:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(83946),a=r(19013),s=r(13882);function i(e,t){(0,s.Z)(2,arguments);var r=(0,a.Z)(e),i=(0,n.Z)(t);if(isNaN(i))return new Date(NaN);if(!i)return r;var o=r.getDate(),l=new Date(r.getTime());return(l.setMonth(r.getMonth()+i+1,0),o>=l.getDate())?l:(r.setFullYear(l.getFullYear(),l.getMonth(),o),r)}},92794:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/viewer-info",function(){return r(84501)}])},54615:function(e,t,r){"use strict";r.d(t,{k:function(){return d}});var n=r(85893),a=r(58091),s=r(67294),i=r(23430),o=r(23148),l=r(26495),u=r(71577);function c(e){let t={};return e.forEach(e=>{let r=new Date(e.time),n=(0,a.Z)(r,"H:mma");t[n]=e.value}),t}o.kL.register(o.uw,o.WV,o.f$,o.od,o.jn,o.Dx,o.u,o.De);let d=e=>{let{data:t,title:r,color:a,unit:o,dataCollections:d,yFlipped:f,yLogarithmic:h,minYValue:m,yStepSize:x=0}=e,p=[],y=(0,s.useRef)(null),g=()=>{if(y.current){let e=document.createElement("a");e.download="chart.png",e.href=y.current.canvas.toDataURL(),e.click()}};return t&&t.length>0&&p.push({id:r,label:r,backgroundColor:a,borderColor:a,borderWidth:3,data:c(t)}),d.forEach(e=>{p.push({id:e.name,label:e.name,data:c(e.data),backgroundColor:e.color,borderColor:e.color,borderWidth:3,pointStyle:e.pointStyle||"circle",radius:e.pointRadius||1})}),(0,n.jsxs)("div",{className:"line-chart-container",children:[(0,n.jsx)(l.x1,{ref:y,data:{datasets:p},options:{responsive:!0,clip:!1,scales:{y:{type:h?"logarithmic":"linear",reverse:f,min:m,ticks:{stepSize:x},title:{display:!0,text:o}}}},height:"70vh"}),(0,n.jsx)(u.Z,{size:"small",onClick:g,type:"ghost",icon:(0,n.jsx)(i.Z,{}),className:"download-btn"})]})};d.defaultProps={dataCollections:[],data:[],title:"",yFlipped:!1,yLogarithmic:!1}},15014:function(e,t,r){"use strict";r.d(t,{m:function(){return h}});var n=r(85893),a=r(85818),s=r(97910),i=r(74763),o=r(59652);let{Text:l}=a.Z,u={title:"",value:0,prefix:null,suffix:null,color:"",progress:!1,centered:!1,formatter:null},c=e=>{let{prefix:t,value:r,suffix:a,title:s}=e;return(0,n.jsxs)("div",{children:[t,(0,n.jsx)("div",{children:(0,n.jsx)(l,{type:"secondary",children:s})}),(0,n.jsx)("div",{children:(0,n.jsxs)(l,{type:"secondary",children:[r,a||"%"]})})]})},d=e=>{let{title:t,value:r,prefix:a,suffix:i,color:o}=e,l=(0,n.jsx)(c,{prefix:a,value:r,suffix:i,title:t});return(0,n.jsx)(s.Z,{type:"dashboard",percent:r,width:120,strokeColor:{"0%":o,"90%":r>90?"red":o},format:()=>l})};d.defaultProps=u;let f=e=>{let{title:t,value:r,prefix:a,formatter:s}=e;return(0,n.jsx)(i.Z,{title:t,value:r,prefix:a,formatter:s})};f.defaultProps=u;let h=e=>{let{progress:t,centered:r}=e,a=t?d:f;return(0,n.jsx)(o.Z,{type:"inner",children:(0,n.jsx)("div",{style:r?{display:"flex",alignItems:"center",justifyContent:"center"}:{},children:(0,n.jsx)(a,{...e})})})};h.defaultProps=u},84501:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return L}});var n=r(85893),a=r(67294),s=r(66516),i=r(85818),o=r(71230),l=r(15746),u=r(14670),c=r(11382),d=r(13013),f=r(77349),h=r(13882),m=r(83946),x=r(11640);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){if((0,h.Z)(2,arguments),!t||"object"!==p(t))return new Date(NaN);var r=t.years?(0,m.Z)(t.years):0,n=t.months?(0,m.Z)(t.months):0,a=t.weeks?(0,m.Z)(t.weeks):0,s=t.days?(0,m.Z)(t.days):0,i=t.hours?(0,m.Z)(t.hours):0,o=t.minutes?(0,m.Z)(t.minutes):0,l=t.seconds?(0,m.Z)(t.seconds):0,u=function(e,t){(0,h.Z)(2,arguments);var r=(0,m.Z)(t);return(0,f.Z)(e,-r)}(function(e,t){(0,h.Z)(2,arguments);var r=(0,m.Z)(t);return(0,x.Z)(e,-r)}(e,n+12*r),s+7*a);return new Date(u.getTime()-1e3*(l+60*(o+60*i)))}var g=r(19013),Z=r(5152),w=r.n(Z),j=r(54615),v=r(15014),b=r(54398),S=r(45938),k=r(37135);let D=e=>{let{data:t}=e;return(0,n.jsx)(b.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:[{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:e=>(0,k.AB)(e)},{title:"Location",dataIndex:"geo",key:"geo",render:e=>e?"".concat(e.regionName,", ").concat(e.countryCode):"-"},{title:"Watch Time",dataIndex:"firstSeen",key:"firstSeen",defaultSortOrder:"ascend",render:e=>(0,S.Z)(new Date(e)),sorter:(e,t)=>new Date(e.firstSeen).getTime()-new Date(t.firstSeen).getTime(),sortDirections:["descend","ascend"]}],dataSource:t,size:"small",rowKey:"id"})};var N=r(38631),C=r(81453),_=r(34261);let P=w()(()=>Promise.all([r.e(2074),r.e(5085)]).then(r.t.bind(r,5085,23)),{loadableGenerated:{webpack:()=>[5085]},ssr:!1}),E=w()(()=>Promise.all([r.e(2074),r.e(5412)]).then(r.t.bind(r,95412,23)),{loadableGenerated:{webpack:()=>[95412]},ssr:!1});function L(){let e;let t=(0,a.useContext)(N.aC),{online:r,broadcaster:f,viewerCount:m,overallPeakViewerCount:x,sessionPeakViewerCount:p}=t||{};f&&f.time&&(e=new Date(f.time));let Z=[{title:"Current stream",start:e},{title:"Last 12 hours",start:y(new Date,{hours:12})},{title:"Last 24 hours",start:y(new Date,{hours:24})},{title:"Last 7 days",start:y(new Date,{days:7})},{title:"Last 30 days",start:y(new Date,{days:30})},{title:"Last 3 months",start:y(new Date,{months:3})},{title:"Last 6 months",start:y(new Date,{months:6})}],[w,b]=(0,a.useState)(!0),[S,k]=(0,a.useState)([]),[_,L]=(0,a.useState)([]),[T,I]=(0,a.useState)(Z[1]),M=async()=>{try{let e="".concat(C.iV,"?windowStart=").concat(function(e){return(0,h.Z)(1,arguments),Math.floor(function(e){return(0,h.Z)(1,arguments),(0,g.Z)(e).getTime()}(e)/1e3)}(T.start)),t=await (0,C.rQ)(e);k(t),b(!1)}catch(e){console.log("==== error",e)}try{let e=await (0,C.rQ)(C.a_);L(e)}catch(e){console.log("==== error",e)}};(0,a.useEffect)(()=>{let e=null;return(M(),r)?(e=setInterval(M,6e4),()=>{clearInterval(e)}):()=>[]},[r,T]);let A=e=>{let{key:t}=e;I(Z[t])},V=(0,n.jsxs)(s.Z,{children:[r&&e&&(0,n.jsx)(s.Z.Item,{onClick:A,children:Z[0].title},"0"),Z.slice(1).map((e,t)=>(0,n.jsx)(s.Z.Item,{onClick:A,children:e.title},t+1))]});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Z.Title,{children:"Viewer Info"}),(0,n.jsx)("br",{}),(0,n.jsxs)(o.Z,{gutter:[16,16],justify:"space-around",children:[r&&(0,n.jsx)(l.Z,{span:8,md:8,children:(0,n.jsx)(v.m,{title:"Current viewers",value:m.toString(),prefix:(0,n.jsx)(E,{})})}),(0,n.jsx)(l.Z,{md:r?8:12,children:(0,n.jsx)(v.m,{title:r?"Max viewers this stream":"Max viewers last stream",value:p.toString(),prefix:(0,n.jsx)(E,{})})}),(0,n.jsx)(l.Z,{md:r?8:12,children:(0,n.jsx)(v.m,{title:"All-time max viewers",value:x.toString(),prefix:(0,n.jsx)(E,{})})})]}),!S.length&&(0,n.jsx)(u.Z,{style:{marginTop:"10px"},banner:!0,message:"Please wait",description:"No viewer data has been collected yet.",type:"info"}),(0,n.jsxs)(c.Z,{spinning:!S.length||w,children:[(0,n.jsx)(d.Z,{overlay:V,trigger:["click"],children:(0,n.jsxs)("button",{type:"button",style:{float:"right",background:"transparent",border:"unset"},children:[T.title," ",(0,n.jsx)(P,{})]})}),S.length>0&&(0,n.jsx)(j.k,{title:"Viewers",data:S,color:"#2087E2",unit:"viewers",minYValue:0,yStepSize:1}),(0,n.jsx)(D,{data:_})]})]})}L.getLayout=function(e){return(0,n.jsx)(_.l,{page:e})}}},function(e){e.O(0,[2196,173,5874,2184,2414,4931,5402,5257,1664,8014,5818,9915,4041,3698,3013,4398,7940,4526,5938,428,3946,6894,4261,9774,2888,179],function(){return e(e.s=92794)}),_N_E=e.O()}]);