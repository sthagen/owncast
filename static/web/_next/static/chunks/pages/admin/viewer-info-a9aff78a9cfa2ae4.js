(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6109],{25378:function(e,t,n){"use strict";var r=n(67294),a=n(57838),i=n(24308);t.Z=function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,r.useRef)({}),n=(0,a.Z)();return(0,r.useEffect)(function(){var r=i.ZP.subscribe(function(r){t.current=r,e&&n()});return function(){return i.ZP.unsubscribe(r)}},[]),t.current}},11382:function(e,t,n){"use strict";var r=n(87462),a=n(4942),i=n(97685),s=n(94184),o=n.n(s),l=n(23279),c=n.n(l),u=n(98423),d=n(67294),f=n(53124),m=n(96159),p=n(93355),v=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)0>t.indexOf(r[a])&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n};(0,p.b)("small","default","large");var h=null,x=function(e){var t=e.spinPrefixCls,n=e.spinning,s=void 0===n||n,l=e.delay,p=e.className,x=e.size,y=void 0===x?"default":x,g=e.tip,Z=e.wrapperClassName,w=e.style,b=e.children,j=v(e,["spinPrefixCls","spinning","delay","className","size","tip","wrapperClassName","style","children"]),N=d.useState(function(){return s&&(!s||!l||!!isNaN(Number(l)))}),E=(0,i.Z)(N,2),C=E[0],D=E[1];return d.useEffect(function(){var e=c()(function(){D(s)},l);return e(),function(){var t;null===(t=null==e?void 0:e.cancel)||void 0===t||t.call(e)}},[l,s]),d.createElement(f.C,null,function(n){var i,s,l,c=n.direction,f=o()(t,(l={},(0,a.Z)(l,"".concat(t,"-sm"),"small"===y),(0,a.Z)(l,"".concat(t,"-lg"),"large"===y),(0,a.Z)(l,"".concat(t,"-spinning"),C),(0,a.Z)(l,"".concat(t,"-show-text"),!!g),(0,a.Z)(l,"".concat(t,"-rtl"),"rtl"===c),l),p),v=(0,u.Z)(j,["indicator","prefixCls"]),x=d.createElement("div",(0,r.Z)({},v,{style:w,className:f,"aria-live":"polite","aria-busy":C}),(i=e.indicator,s="".concat(t,"-dot"),null===i?null:(0,m.l$)(i)?(0,m.Tm)(i,{className:o()(i.props.className,s)}):(0,m.l$)(h)?(0,m.Tm)(h,{className:o()(h.props.className,s)}):d.createElement("span",{className:o()(s,"".concat(t,"-dot-spin"))},d.createElement("i",{className:"".concat(t,"-dot-item")}),d.createElement("i",{className:"".concat(t,"-dot-item")}),d.createElement("i",{className:"".concat(t,"-dot-item")}),d.createElement("i",{className:"".concat(t,"-dot-item")}))),g?d.createElement("div",{className:"".concat(t,"-text")},g):null);if(void 0!==b){var N=o()("".concat(t,"-container"),(0,a.Z)({},"".concat(t,"-blur"),C));return d.createElement("div",(0,r.Z)({},v,{className:o()("".concat(t,"-nested-loading"),Z)}),C&&d.createElement("div",{key:"loading"},x),d.createElement("div",{className:N,key:"container"},b))}return x})},y=function(e){var t=e.prefixCls,n=(0,d.useContext(f.E_).getPrefixCls)("spin",t),a=(0,r.Z)((0,r.Z)({},e),{spinPrefixCls:n});return d.createElement(x,(0,r.Z)({},a))};y.setDefaultIndicator=function(e){h=e},t.Z=y},77349:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(83946),a=n(19013),i=n(13882);function s(e,t){(0,i.Z)(2,arguments);var n=(0,a.Z)(e),s=(0,r.Z)(t);return isNaN(s)?new Date(NaN):(s&&n.setDate(n.getDate()+s),n)}},11640:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(83946),a=n(19013),i=n(13882);function s(e,t){(0,i.Z)(2,arguments);var n=(0,a.Z)(e),s=(0,r.Z)(t);if(isNaN(s))return new Date(NaN);if(!s)return n;var o=n.getDate(),l=new Date(n.getTime());return(l.setMonth(n.getMonth()+s+1,0),o>=l.getDate())?l:(n.setFullYear(l.getFullYear(),l.getMonth(),o),n)}},23279:function(e,t,n){var r=n(13218),a=n(7771),i=n(14841),s=Math.max,o=Math.min;e.exports=function(e,t,n){var l,c,u,d,f,m,p=0,v=!1,h=!1,x=!0;if("function"!=typeof e)throw TypeError("Expected a function");function y(t){var n=l,r=c;return l=c=void 0,p=t,d=e.apply(r,n)}function g(e){var n=e-m,r=e-p;return void 0===m||n>=t||n<0||h&&r>=u}function Z(){var e,n,r,i=a();if(g(i))return w(i);f=setTimeout(Z,(e=i-m,n=i-p,r=t-e,h?o(r,u-n):r))}function w(e){return(f=void 0,x&&l)?y(e):(l=c=void 0,d)}function b(){var e,n=a(),r=g(n);if(l=arguments,c=this,m=n,r){if(void 0===f)return p=e=m,f=setTimeout(Z,t),v?y(e):d;if(h)return clearTimeout(f),f=setTimeout(Z,t),y(m)}return void 0===f&&(f=setTimeout(Z,t)),d}return t=i(t)||0,r(n)&&(v=!!n.leading,u=(h="maxWait"in n)?s(i(n.maxWait)||0,t):u,x="trailing"in n?!!n.trailing:x),b.cancel=function(){void 0!==f&&clearTimeout(f),p=0,l=m=c=f=void 0},b.flush=function(){return void 0===f?d:w(a())},b}},7771:function(e,t,n){var r=n(55639);e.exports=function(){return r.Date.now()}},92794:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/viewer-info",function(){return n(25715)}])},36435:function(e,t,n){"use strict";n.d(t,{k:function(){return l}});var r=n(85893),a=n(58091),i=n(23148),s=n(26495);function o(e){let t={};return e.forEach(e=>{let n=new Date(e.time),r=(0,a.Z)(n,"H:mma");t[r]=e.value}),t}i.kL.register(i.uw,i.WV,i.f$,i.od,i.jn,i.Dx,i.u,i.De);let l=e=>{let{data:t,title:n,color:a,unit:i,dataCollections:l,yFlipped:c,yLogarithmic:u}=e,d=[];return t&&t.length>0&&d.push({id:n,label:n,backgroundColor:a,borderColor:a,borderWidth:3,data:o(t)}),l.forEach(e=>{d.push({id:e.name,label:e.name,data:o(e.data),backgroundColor:e.color,borderColor:e.color,borderWidth:3,pointStyle:e.pointStyle||"circle",radius:e.pointRadius||1})}),(0,r.jsx)("div",{className:"line-chart-container",children:(0,r.jsx)(s.x1,{data:{datasets:d},options:{responsive:!0,scales:{y:{type:u?"logarithmic":"linear",reverse:c,title:{display:!0,text:i}}}},height:"70vh"})})};l.defaultProps={dataCollections:[],data:[],title:"",yFlipped:!1,yLogarithmic:!1}},23589:function(e,t,n){"use strict";n.d(t,{m:function(){return m}});var r=n(85893),a=n(85818),i=n(97910),s=n(74763),o=n(59652);let{Text:l}=a.Z,c={title:"",value:0,prefix:null,suffix:null,color:"",progress:!1,centered:!1,formatter:null},u=e=>{let{prefix:t,value:n,suffix:a,title:i}=e;return(0,r.jsxs)("div",{children:[t,(0,r.jsx)("div",{children:(0,r.jsx)(l,{type:"secondary",children:i})}),(0,r.jsx)("div",{children:(0,r.jsxs)(l,{type:"secondary",children:[n,a||"%"]})})]})},d=e=>{let{title:t,value:n,prefix:a,suffix:s,color:o}=e,l=(0,r.jsx)(u,{prefix:a,value:n,suffix:s,title:t});return(0,r.jsx)(i.Z,{type:"dashboard",percent:n,width:120,strokeColor:{"0%":o,"90%":n>90?"red":o},format:()=>l})};d.defaultProps=c;let f=e=>{let{title:t,value:n,prefix:a,formatter:i}=e;return(0,r.jsx)(s.Z,{title:t,value:n,prefix:a,formatter:i})};f.defaultProps=c;let m=e=>{let{progress:t,centered:n}=e,a=t?d:f;return(0,r.jsx)(o.Z,{type:"inner",children:(0,r.jsx)("div",{style:n?{display:"flex",alignItems:"center",justifyContent:"center"}:{},children:(0,r.jsx)(a,{...e})})})};m.defaultProps=c},25715:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var r=n(85893),a=n(67294),i=n(66516),s=n(85818),o=n(71230),l=n(15746),c=n(14670),u=n(11382),d=n(13013),f=n(77349),m=n(13882),p=n(83946),v=n(11640);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){if((0,m.Z)(2,arguments),!t||"object"!==h(t))return new Date(NaN);var n=t.years?(0,p.Z)(t.years):0,r=t.months?(0,p.Z)(t.months):0,a=t.weeks?(0,p.Z)(t.weeks):0,i=t.days?(0,p.Z)(t.days):0,s=t.hours?(0,p.Z)(t.hours):0,o=t.minutes?(0,p.Z)(t.minutes):0,l=t.seconds?(0,p.Z)(t.seconds):0,c=function(e,t){(0,m.Z)(2,arguments);var n=(0,p.Z)(t);return(0,f.Z)(e,-n)}(function(e,t){(0,m.Z)(2,arguments);var n=(0,p.Z)(t);return(0,v.Z)(e,-n)}(e,r+12*n),i+7*a);return new Date(c.getTime()-1e3*(l+60*(o+60*s)))}var y=n(19013),g=n(5152),Z=n.n(g),w=n(36435),b=n(23589),j=n(54398),N=n(45938),E=n(70241);let C=e=>{let{data:t}=e;return(0,r.jsx)(j.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:[{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:e=>(0,E.AB)(e)},{title:"Location",dataIndex:"geo",key:"geo",render:e=>e?"".concat(e.regionName,", ").concat(e.countryCode):"-"},{title:"Watch Time",dataIndex:"firstSeen",key:"firstSeen",defaultSortOrder:"ascend",render:e=>(0,N.Z)(new Date(e)),sorter:(e,t)=>new Date(e.firstSeen).getTime()-new Date(t.firstSeen).getTime(),sortDirections:["descend","ascend"]}],dataSource:t,size:"small",rowKey:"id"})};var D=n(99519),S=n(64777),k=n(6960);let P=Z()(()=>Promise.all([n.e(2074),n.e(5085)]).then(n.t.bind(n,5085,23)),{loadableGenerated:{webpack:()=>[5085]},ssr:!1}),T=Z()(()=>Promise.all([n.e(2074),n.e(5412)]).then(n.t.bind(n,95412,23)),{loadableGenerated:{webpack:()=>[95412]},ssr:!1});function _(){let e;let t=(0,a.useContext)(D.aC),{online:n,broadcaster:f,viewerCount:p,overallPeakViewerCount:v,sessionPeakViewerCount:h}=t||{};f&&f.time&&(e=new Date(f.time));let g=[{title:"Current stream",start:e},{title:"Last 12 hours",start:x(new Date,{hours:12})},{title:"Last 24 hours",start:x(new Date,{hours:24})},{title:"Last 7 days",start:x(new Date,{days:7})},{title:"Last 30 days",start:x(new Date,{days:30})},{title:"Last 3 months",start:x(new Date,{months:3})},{title:"Last 6 months",start:x(new Date,{months:6})}],[Z,j]=(0,a.useState)(!0),[N,E]=(0,a.useState)([]),[k,_]=(0,a.useState)([]),[O,I]=(0,a.useState)(g[1]),L=async()=>{try{let e="".concat(S.iV,"?windowStart=").concat(function(e){return(0,m.Z)(1,arguments),Math.floor(function(e){return(0,m.Z)(1,arguments),(0,y.Z)(e).getTime()}(e)/1e3)}(O.start)),t=await (0,S.rQ)(e);E(t),j(!1)}catch(e){console.log("==== error",e)}try{let e=await (0,S.rQ)(S.a_);_(e)}catch(e){console.log("==== error",e)}};(0,a.useEffect)(()=>{let e=null;return(L(),n)?(e=setInterval(L,6e4),()=>{clearInterval(e)}):()=>[]},[n,O]);let M=e=>{let{key:t}=e;I(g[t])},W=(0,r.jsxs)(i.Z,{children:[n&&e&&(0,r.jsx)(i.Z.Item,{onClick:M,children:g[0].title},"0"),g.slice(1).map((e,t)=>(0,r.jsx)(i.Z.Item,{onClick:M,children:e.title},t+1))]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z.Title,{children:"Viewer Info"}),(0,r.jsx)("br",{}),(0,r.jsxs)(o.Z,{gutter:[16,16],justify:"space-around",children:[n&&(0,r.jsx)(l.Z,{span:8,md:8,children:(0,r.jsx)(b.m,{title:"Current viewers",value:p.toString(),prefix:(0,r.jsx)(T,{})})}),(0,r.jsx)(l.Z,{md:n?8:12,children:(0,r.jsx)(b.m,{title:n?"Max viewers this stream":"Max viewers last stream",value:h.toString(),prefix:(0,r.jsx)(T,{})})}),(0,r.jsx)(l.Z,{md:n?8:12,children:(0,r.jsx)(b.m,{title:"All-time max viewers",value:v.toString(),prefix:(0,r.jsx)(T,{})})})]}),!N.length&&(0,r.jsx)(c.Z,{style:{marginTop:"10px"},banner:!0,message:"Please wait",description:"No viewer data has been collected yet.",type:"info"}),(0,r.jsxs)(u.Z,{spinning:!N.length||Z,children:[(0,r.jsx)(d.Z,{overlay:W,trigger:["click"],children:(0,r.jsxs)("button",{type:"button",style:{float:"right",background:"transparent",border:"unset"},children:[O.title," ",(0,r.jsx)(P,{})]})}),N.length>0&&(0,r.jsx)(w.k,{title:"Viewers",data:N,color:"#2087E2",unit:"viewers"}),(0,r.jsx)(C,{data:k})]})]})}_.getLayout=function(e){return(0,r.jsx)(k.l,{page:e})}}},function(e){e.O(0,[2196,173,164,2744,9680,4931,5402,2231,5818,492,7524,9915,4041,3698,3013,4398,8091,6306,5938,5101,4734,4763,4293,180,6960,9774,2888,179],function(){return e(e.s=92794)}),_N_E=e.O()}]);