(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9522],{57096:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"}},20054:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r=(a=n(32615))&&a.__esModule?a:{default:a};t.default=r,e.exports=r},32615:function(e,t,n){"use strict";var a=n(64836),r=n(18698);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(n(42122)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var a={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=l?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(a,s,o):a[s]=e[s]}return a.default=e,n&&n.set(e,a),a}(n(67294)),o=a(n(57096)),d=a(n(92074));function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}var c=function(e,t){return s.createElement(d.default,(0,l.default)((0,l.default)({},e),{},{ref:t,icon:o.default}))};c.displayName="PlusOutlined";var u=s.forwardRef(c);t.default=u},42698:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function(){return null}},1286:function(e,t,n){"use strict";var a=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{inkBar:!0,tabPane:!1};return(t=!1===n?{inkBar:!1,tabPane:!1}:!0===n?{inkBar:!0,tabPane:!0}:(0,l.default)({inkBar:!0},"object"===(0,r.default)(n)?n:{})).tabPane&&(t.tabPaneMotion=(0,l.default)((0,l.default)({},o),{motionName:(0,s.getTransitionName)(e,"switch")})),t};var r=a(n(18698)),l=a(n(10434)),s=n(53683),o={motionAppear:!1,motionEnter:!0,motionLeave:!0}},47397:function(e,t,n){"use strict";var a=n(75263).default,r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e||(0,o.default)(t).map(function(e){if(s.isValidElement(e)){var t=e.key,n=e.props||{},a=n.tab,r=d(n,["tab"]);return(0,l.default)((0,l.default)({key:String(t)},r),{label:a})}return null}).filter(function(e){return e})};var l=r(n(10434)),s=a(n(67294)),o=r(n(45598));r(n(13594));var d=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)0>t.indexOf(a[r])&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n}},20838:function(e,t,n){"use strict";var a=n(75263).default,r=n(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n(38416)),s=r(n(10434)),o=r(n(40753)),d=r(n(26937)),i=r(n(20054)),c=r(n(94184)),u=r(n(93068)),f=a(n(67294)),m=n(31929),p=r(n(3236));r(n(13594));var h=r(n(1286)),b=r(n(47397)),y=r(n(42698)),x=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)0>t.indexOf(a[r])&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n};function j(e){var t,n=e.type,a=e.className,r=e.size,y=e.onEdit,j=e.hideAdd,g=e.centered,v=e.addIcon,w=e.children,k=e.items,O=e.animated,P=x(e,["type","className","size","onEdit","hideAdd","centered","addIcon","children","items","animated"]),C=P.prefixCls,N=P.moreIcon,A=void 0===N?f.createElement(d.default,null):N,T=f.useContext(m.ConfigContext),D=T.getPrefixCls,_=T.direction,M=T.getPopupContainer,I=D("tabs",C);"editable-card"===n&&(t={onEdit:function(e,t){var n=t.key,a=t.event;null==y||y("add"===e?a:n,e)},removeIcon:f.createElement(o.default,null),addIcon:v||f.createElement(i.default,null),showAdd:!0!==j});var E=D(),S=(0,b.default)(k,w),Z=(0,h.default)(I,O);return f.createElement(p.default.Consumer,null,function(e){var o,d=void 0!==r?r:e;return f.createElement(u.default,(0,s.default)({direction:_,getPopupContainer:M,moreTransitionName:"".concat(E,"-slide-up")},P,{items:S,className:(0,c.default)((o={},(0,l.default)(o,"".concat(I,"-").concat(d),d),(0,l.default)(o,"".concat(I,"-card"),["card","editable-card"].includes(n)),(0,l.default)(o,"".concat(I,"-editable-card"),"editable-card"===n),(0,l.default)(o,"".concat(I,"-centered"),g),o),a),editable:t,moreIcon:A,prefixCls:I,animated:Z}))})}j.TabPane=y.default,t.default=j},55583:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/chat/users",function(){return n(50447)}])},20449:function(e,t,n){"use strict";n.d(t,{e:function(){return f}});var a=n(85893),r=n(56697),l=n(65400),s=n(5152),o=n.n(s),d=n(81453);let i=o()(()=>Promise.resolve().then(n.t.bind(n,42461,23)),{loadableGenerated:{webpack:()=>[42461]},ssr:!1}),c=o()(()=>n.e(1538).then(n.t.bind(n,11538,23)),{loadableGenerated:{webpack:()=>[11538]},ssr:!1}),u=o()(()=>n.e(6773).then(n.t.bind(n,6773,23)),{loadableGenerated:{webpack:()=>[6773]},ssr:!1}),f=e=>{let{user:t,isEnabled:n,label:s,onClick:o}=e;async function f(e){let{id:t}=e;try{let e=await (0,d.rQ)(d.NM,{data:{userId:t,enabled:!n},method:"POST",auth:!0});return e.success}catch(e){console.error(e)}return!1}let m=n?"ban":"unban",p=n?(0,a.jsx)(i,{style:{color:"var(--ant-error)"}}):(0,a.jsx)(c,{style:{color:"var(--ant-warning)"}}),h=(0,a.jsxs)(a.Fragment,{children:["Are you sure you want to ",m," ",(0,a.jsx)("strong",{children:t.displayName}),n?" and remove their messages?":"?"]});return(0,a.jsx)(l.default,{type:"primary",onClick:()=>{r.default.confirm({title:"Confirm ".concat(m),content:h,onCancel:()=>{},onOk:()=>new Promise((e,n)=>{let a=f(t);a?setTimeout(()=>{e(a),null==o||o()},3e3):n()}),okType:"danger",okText:n?"Absolutely":null,icon:p})},size:"small",icon:n?(0,a.jsx)(u,{twoToneColor:"#ff4d4f"}):null,className:"block-user-button",children:s||m})};f.defaultProps={label:"",onClick:null}},14840:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}});var a=n(85893),r=n(67294),l=n(74253),s=n(56697),o=n(53740),d=n(55673),i=n(5789),c=n(74048),u=n(94055),f=n(45938),m=n(58091),p=n(44908),h=n.n(p),b=n(20449),y=n(65400),x=n(5152),j=n.n(x),g=n(81453);let v=j()(()=>Promise.resolve().then(n.t.bind(n,42461,23)),{loadableGenerated:{webpack:()=>[42461]},ssr:!1}),w=j()(()=>n.e(1538).then(n.t.bind(n,11538,23)),{loadableGenerated:{webpack:()=>[11538]},ssr:!1}),k=j()(()=>n.e(6773).then(n.t.bind(n,6773,23)),{loadableGenerated:{webpack:()=>[6773]},ssr:!1}),O=j()(()=>n.e(4612).then(n.t.bind(n,64612,23)),{loadableGenerated:{webpack:()=>[64612]},ssr:!1}),P=e=>{var t;let{user:n,onClick:r}=e;async function l(e,t){let{id:n}=e;try{let e=await (0,g.rQ)(g.jr,{data:{userId:n,isModerator:t},method:"POST",auth:!0});return e.success}catch(e){console.error(e)}return!1}let o=null===(t=n.scopes)||void 0===t?void 0:t.includes("MODERATOR"),d=o?"remove moderator":"add moderator",i=o?(0,a.jsx)(v,{style:{color:"var(--ant-error)"}}):(0,a.jsx)(w,{style:{color:"var(--ant-warning)"}}),c=(0,a.jsxs)(a.Fragment,{children:["Are you sure you want to ",d," ",(0,a.jsx)("strong",{children:n.displayName}),"?"]});return(0,a.jsx)(y.default,{type:"primary",onClick:()=>{s.default.confirm({title:"Confirm ".concat(d),content:c,onCancel:()=>{},onOk:()=>new Promise((e,t)=>{let a=l(n,!o);a?setTimeout(()=>{e(a),null==r||r()},3e3):t()}),okType:"danger",okText:o?"Yup!":null,icon:i})},size:"small",icon:o?(0,a.jsx)(k,{twoToneColor:"#ff4d4f"}):(0,a.jsx)(O,{twoToneColor:"#22bb44"}),className:"block-user-button",children:d})};P.defaultProps={onClick:null};var C=n(53736),N=n(37135);let A=e=>{let{user:t,connectionInfo:n,children:p}=e,[y,x]=(0,r.useState)(!1),j=()=>{x(!1)},{displayName:g,createdAt:v,previousNames:w,nameChangedAt:k,disabledAt:O}=t,{connectedAt:A,messageCount:T,userAgent:D}=n||{},_=null,M=w&&[...w];w&&w.length>1&&k&&(_=new Date(k),M.reverse());let I=new Date(v),E=(0,m.Z)(I,"PP pp"),S=_?(0,f.Z)(_):null;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.default,{title:(0,a.jsxs)(a.Fragment,{children:["Created at: ",E,".",(0,a.jsx)("br",{})," Click for more info."]}),placement:"bottomLeft",children:(0,a.jsx)("button",{type:"button","aria-label":"Display more details about this user",className:"user-item-container",onClick:()=>{x(!0)},children:p})}),(0,a.jsx)(s.default,{destroyOnClose:!0,width:600,cancelText:"Close",okButtonProps:{style:{display:"none"}},title:"User details: ".concat(g),open:y,onOk:j,onCancel:j,children:(0,a.jsxs)("div",{className:"user-details",children:[(0,a.jsx)(o.default.Title,{level:4,children:g}),(0,a.jsxs)("p",{className:"created-at",children:["User created at ",E,"."]}),(0,a.jsxs)(d.Z,{gutter:16,children:[n&&(0,a.jsxs)(i.Z,{md:_?12:24,children:[(0,a.jsx)(o.default.Title,{level:5,children:"This user is currently connected to Chat."}),(0,a.jsxs)("ul",{className:"connection-info",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Active for:"})," ",(0,f.Z)(new Date(A))]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Messages sent:"})," ",T]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"User Agent:"}),(0,a.jsx)("br",{}),(0,N.AB)(D)]})]})]}),_&&(0,a.jsxs)(i.Z,{md:n?12:24,children:[(0,a.jsx)(o.default.Title,{level:5,children:"This user is also seen as:"}),(0,a.jsx)("ul",{className:"previous-names-list",children:h()(M).map((e,t)=>(0,a.jsxs)("li",{className:0===t?"latest":"",children:[(0,a.jsx)("span",{className:"user-name-item",children:e}),0===t?" (Changed ".concat(S," ago)"):""]}))})]})]}),(0,a.jsx)(l.Z,{}),(0,a.jsxs)(c.default,{direction:"horizontal",children:[O?(0,a.jsxs)(a.Fragment,{children:["This user was banned on ",(0,a.jsx)("code",{children:(0,C.u)(O)}),".",(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),(0,a.jsx)(b.e,{label:"Unban this user",user:t,isEnabled:!1,onClick:j})]}):(0,a.jsx)(b.e,{label:"Ban this user",user:t,isEnabled:!0,onClick:j}),(0,a.jsx)(P,{user:t,onClick:j})]})]})})]})};A.defaultProps={connectionInfo:null}},53736:function(e,t,n){"use strict";n.d(t,{K:function(){return i},u:function(){return d}});var a=n(85893),r=n(2307),l=n(58091),s=n(14840),o=n(20449);function d(e){let t=new Date(e);return t.getFullYear()!==new Date().getFullYear()?(0,l.Z)(new Date(e),"MMM d, yyyy H:mma"):(0,l.Z)(new Date(e),"MMM d H:mma")}let i=e=>{let{data:t}=e,n=[{title:"Last Known Display Name",dataIndex:"displayName",key:"displayName",render:(e,t)=>(0,a.jsx)(s.Z,{user:t,children:(0,a.jsx)("span",{className:"display-name",children:e})})},{title:"Created",dataIndex:"createdAt",key:"createdAt",render:e=>d(e),sorter:(e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime(),sortDirections:["descend","ascend"]},{title:"Disabled at",dataIndex:"disabledAt",key:"disabledAt",defaultSortOrder:"descend",render:e=>e?d(e):null,sorter:(e,t)=>new Date(e.disabledAt).getTime()-new Date(t.disabledAt).getTime(),sortDirections:["descend","ascend"]},{title:"",key:"block",className:"actions-col",render:(e,t)=>(0,a.jsx)(o.e,{user:t,isEnabled:!t.disabledAt})}];return(0,a.jsx)(r.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:n,dataSource:t,size:"small",rowKey:"id"})}},50447:function(e,t,n){"use strict";n.r(t),n.d(t,{FETCH_INTERVAL:function(){return P},default:function(){return C}});var a=n(85893),r=n(67294),l=n(20838),s=n(38631),o=n(81453),d=n(53736),i=n(51024),c=n(2307),u=n(45938),f=n(5152),m=n.n(f),p=n(14840),h=n(20449),b=n(37135);let y=m()(()=>Promise.resolve().then(n.t.bind(n,49153,23)),{loadableGenerated:{webpack:()=>[49153]},ssr:!1}),x=e=>{let{data:t}=e,n=[{title:"Display Name",key:"username",render:e=>{let{user:t,connectedAt:n,messageCount:r,userAgent:l}=e;return(0,a.jsx)(p.Z,{user:t,connectionInfo:{connectedAt:n,messageCount:r,userAgent:l},children:(0,a.jsx)("span",{className:"display-name",children:t.displayName})})},sorter:(e,t)=>t.user.displayName.localeCompare(e.user.displayName),filterIcon:(0,a.jsx)(y,{}),filterDropdown:e=>{let{setSelectedKeys:t,selectedKeys:n,confirm:r}=e;return(0,a.jsx)("div",{style:{padding:8},children:(0,a.jsx)(i.default,{placeholder:"Search display names...",value:n[0],onChange:e=>{t(e.target.value?[e.target.value]:[]),r({closeDropdown:!1})}})})},onFilter:(e,t)=>t.user.displayName.includes(e),sortDirections:["descend","ascend"]},{title:"Messages sent",dataIndex:"messageCount",key:"messageCount",className:"number-col",width:"12%",sorter:(e,t)=>e.messageCount-t.messageCount,sortDirections:["descend","ascend"],render:e=>(0,a.jsx)("div",{style:{textAlign:"center"},children:e})},{title:"Connected Time",dataIndex:"connectedAt",key:"connectedAt",defaultSortOrder:"ascend",render:e=>(0,u.Z)(new Date(e)),sorter:(e,t)=>new Date(t.connectedAt).getTime()-new Date(e.connectedAt).getTime(),sortDirections:["descend","ascend"]},{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:e=>(0,b.AB)(e)},{title:"Location",dataIndex:"geo",key:"geo",render:e=>e?"".concat(e.regionName,", ").concat(e.countryCode):"-"},{title:"",key:"block",className:"actions-col",render:(e,t)=>(0,a.jsx)(h.e,{user:t.user,isEnabled:!t.user.disabledAt})}];return(0,a.jsx)(c.Z,{className:"table-container",pagination:{hideOnSinglePage:!0},columns:n,dataSource:t,size:"small",rowKey:"id"})};var j=n(65400),g=n(58091);let v=m()(()=>n.e(6773).then(n.t.bind(n,6773,23)),{loadableGenerated:{webpack:()=>[6773]},ssr:!1});async function w(e){try{await (0,o.rQ)(o.RB,{data:{value:e},method:"POST",auth:!0})}catch(e){console.error(e)}}let k=e=>{let{data:t}=e,n=[{title:"IP Address",dataIndex:"ipAddress",key:"ipAddress"},{title:"Reason",dataIndex:"notes",key:"notes"},{title:"Created",dataIndex:"createdAt",key:"createdAt",render:e=>(0,g.Z)(new Date(e),"MMM d H:mma"),sorter:(e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime(),sortDirections:["descend","ascend"]},{title:"",key:"block",className:"actions-col",render:(e,t)=>(0,a.jsx)(j.default,{title:"Remove IP Address Ban",onClick:()=>w(t.ipAddress),icon:(0,a.jsx)(v,{twoToneColor:"#ff4d4f"}),className:"block-user-button"})}];return(0,a.jsx)(c.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:n,dataSource:t,size:"large",rowKey:"ipAddress"})};var O=n(34261);let P=1e4;function C(){let e=(0,r.useContext)(s.a),{online:t}=e||{},[n,i]=(0,r.useState)([]),[c,u]=(0,r.useState)([]),[f,m]=(0,r.useState)([]),[p,h]=(0,r.useState)([]),b=async()=>{try{let e=await (0,o.rQ)(o.qk);i(e)}catch(e){console.log("==== error",e)}try{let e=await (0,o.rQ)(o.Kp);m(e)}catch(e){console.log("==== error",e)}try{let e=await (0,o.rQ)(o.GC);h(e)}catch(e){console.error("error fetching moderators",e)}try{let e=await (0,o.rQ)(o.Bu);u(e)}catch(e){console.error("error fetching banned ips",e)}};(0,r.useEffect)(()=>{let e=null;return b(),e=setInterval(b,P),()=>{clearInterval(e)}},[t]);let y=t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x,{data:f}),(0,a.jsxs)("p",{className:"description",children:["Visit the"," ",(0,a.jsx)("a",{href:"https://owncast.online/docs/viewers/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"documentation"})," ","to configure additional details about your viewers."]})]}):(0,a.jsx)("p",{className:"description",children:"When a stream is active and chat is enabled, connected chat clients will be displayed here."}),j=(0,a.jsxs)("span",{children:["Connected ",t?"(".concat(f.length,")"):"(offline)"]}),g=(0,a.jsxs)("span",{children:["Banned Users (",n.length,")"]}),v=(0,a.jsx)(d.K,{data:n}),w=(0,a.jsxs)("span",{children:["IP Bans (",c.length,")"]}),O=(0,a.jsx)(k,{data:c}),C=(0,a.jsxs)("span",{children:["Moderators (",p.length,")"]}),N=(0,a.jsx)(d.K,{data:p});return(0,a.jsx)(l.default,{defaultActiveKey:"1",items:[{label:j,key:"1",children:y},{label:g,key:"2",children:v},{label:w,key:"3",children:O},{label:C,key:"4",children:N}]})}C.getLayout=function(e){return(0,a.jsx)(O.l,{page:e})}}},function(e){e.O(0,[5596,1130,4104,9403,1024,3942,971,6697,1664,1749,1700,2122,9552,7752,5891,2891,4749,6627,8966,3068,8091,5938,686,4261,9774,2888,179],function(){return e(e.s=55583)}),_N_E=e.O()}]);