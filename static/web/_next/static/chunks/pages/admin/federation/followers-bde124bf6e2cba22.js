(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2476],{89675:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/federation/followers",function(){return n(70448)}])},70448:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var r=n(85893),a=n(67294),l=n(2307),i=n(84960),s=n(65400),d=n(20838),o=n(58091),c=n(5152),u=n.n(c),h=n(38631),m=n(81453),p=n(37135),w=n(34261);let g=u()(()=>n.e(6910).then(n.t.bind(n,66910,23)),{loadableGenerated:{webpack:()=>[66910]},ssr:!1}),x=u()(()=>n.e(6139).then(n.t.bind(n,26139,23)),{loadableGenerated:{webpack:()=>[26139]},ssr:!1}),f=e=>{let{data:t,tableColumns:n,totalCount:a,setCurrentPage:i}=e;return(0,r.jsx)(l.Z,{dataSource:t,columns:n,size:"small",rowKey:e=>e.link,pagination:{pageSize:25,hideOnSinglePage:!0,showSizeChanger:!1,total:a},onChange:e=>{let t=e.current;i(t)}})};function k(){let[e,t]=(0,a.useState)([]),[n,c]=(0,a.useState)([]),[u,w]=(0,a.useState)([]),[k,y]=(0,a.useState)(0),[j,b]=(0,a.useState)(0),S=(0,a.useContext)(h.a),{serverConfig:v}=S||{},{federation:D}=v,{isPrivate:_}=D,I=async()=>{try{let e="".concat(m.HP,"?offset=").concat(25*j,"&limit=").concat(25),r=await (0,m.rQ)(e,{auth:!0}),{results:a,total:l}=r;(0,p.Qr)(a)?w([]):(y(l),w(a));let i=await (0,m.rQ)(m.E8,{auth:!0});(0,p.Qr)(i)?t([]):t(i);let s=await (0,m.rQ)(m.Y9,{auth:!0});(0,p.Qr)(n)?c([]):c(s)}catch(e){console.log("==== error",e)}};(0,a.useEffect)(()=>{I()},[]);let T=[{title:"",dataIndex:"image",key:"image",width:90,render:e=>(0,r.jsx)(i.ZP,{size:40,src:e||"/img/logo.svg"})},{title:"Name",dataIndex:"name",key:"name",render:(e,t)=>(0,r.jsx)("a",{href:t.link,target:"_blank",rel:"noreferrer",children:t.name||t.username})},{title:"URL",dataIndex:"link",key:"link",render:(e,t)=>(0,r.jsx)("a",{href:t.link,target:"_blank",rel:"noreferrer",children:t.link})}];async function C(e){try{await (0,m.rQ)(m.kb,{auth:!0,method:"POST",data:{actorIRI:e.link,approved:!0}}),I()}catch(e){console.error(e)}}async function P(e){try{await (0,m.rQ)(m.kb,{auth:!0,method:"POST",data:{actorIRI:e.link,approved:!1}}),I()}catch(e){console.error(e)}}let F=[...T];F.unshift({title:"Approve",dataIndex:null,key:null,render:e=>(0,r.jsx)(s.default,{type:"primary",icon:(0,r.jsx)(g,{}),onClick:()=>{C(e)}}),width:50},{title:"Reject",dataIndex:null,key:null,render:e=>(0,r.jsx)(s.default,{type:"primary",danger:!0,icon:(0,r.jsx)(x,{}),onClick:()=>{P(e)}}),width:50}),F.push({title:"Requested",dataIndex:"timestamp",key:"requested",width:200,render:e=>{let t=new Date(e);return(0,r.jsx)(r.Fragment,{children:(0,o.Z)(t,"P")})},sorter:(e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime(),sortDirections:["descend","ascend"],defaultSortOrder:"descend"});let O=[...T];O.unshift({title:"Approve",dataIndex:null,key:null,render:e=>(0,r.jsx)(s.default,{type:"primary",icon:(0,r.jsx)(g,{}),size:"large",onClick:()=>{C(e)}}),width:50}),O.push({title:"Requested",dataIndex:"timestamp",key:"requested",width:200,render:e=>{let t=new Date(e);return(0,r.jsx)(r.Fragment,{children:(0,o.Z)(t,"P")})},sorter:(e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime(),sortDirections:["descend","ascend"],defaultSortOrder:"descend"},{title:"Rejected/Blocked",dataIndex:"timestamp",key:"disabled_at",width:200,render:e=>{let t=new Date(e);return(0,r.jsx)(r.Fragment,{children:(0,o.Z)(t,"P")})},sorter:(e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime(),sortDirections:["descend","ascend"],defaultSortOrder:"descend"});let R=[...T];R.push({title:"Added",dataIndex:"timestamp",key:"timestamp",width:200,render:e=>{let t=new Date(e);return(0,r.jsx)(r.Fragment,{children:(0,o.Z)(t,"P")})},sorter:(e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime(),sortDirections:["descend","ascend"],defaultSortOrder:"descend"},{title:"Remove",dataIndex:null,key:null,render:e=>(0,r.jsx)(s.default,{type:"primary",danger:!0,icon:(0,r.jsx)(x,{}),onClick:()=>{P(e)}}),width:50});let E=(0,r.jsxs)("span",{children:["Followers ",k>0&&"(".concat(k,")")]}),Q=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"The following accounts get notified when you go live or send a post."}),(0,r.jsx)(f,{data:u,tableColumns:R,totalCount:k,setCurrentPage:b})]}),Z=(0,r.jsxs)("span",{children:["Requests ",e.length>0&&"(".concat(e.length,")")]}),z=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:["The following people are requesting to follow your Owncast server on the"," ",(0,r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Fediverse",target:"_blank",rel:"noopener noreferrer",children:"Fediverse"})," ","and be alerted to when you go live. Each must be approved."]}),(0,r.jsx)(l.Z,{dataSource:e,columns:F,size:"small",rowKey:e=>e.link})]}),N=(0,r.jsxs)("span",{children:["Blocked ",n.length>0&&"(".concat(n.length,")")]}),q=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:"The following people were either rejected or blocked by you. You can approve them as a follower."}),(0,r.jsx)("p",{children:(0,r.jsx)(l.Z,{dataSource:n,columns:O,size:"small",rowKey:e=>e.link})})]});return(0,r.jsx)("div",{className:"followers-section",children:(0,r.jsx)(d.default,{defaultActiveKey:"1",items:[{label:E,key:"1",children:Q},_&&{label:Z,key:"2",children:z},{label:N,key:"3",children:q}]})})}k.getLayout=function(e){return(0,r.jsx)(w.l,{page:e})}}},function(e){e.O(0,[5596,1130,4104,9403,1024,3942,971,6697,1664,1749,2122,9552,7752,5891,2891,4749,6627,8966,3068,8091,1051,4261,9774,2888,179],function(){return e(e.s=89675)}),_N_E=e.O()}]);