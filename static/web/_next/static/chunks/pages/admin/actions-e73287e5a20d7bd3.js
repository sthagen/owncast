(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5685],{13882:function(e,t,n){"use strict";function r(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{Z:function(){return r}})},93645:function(e,t,n){"use strict";n.d(t,{u:function(){return a}});var r={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}};function a(e){return e?r[e]:r.trunc}},59910:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(19013),a=n(13882);function l(e,t){return(0,a.Z)(2,arguments),(0,r.Z)(e).getTime()-(0,r.Z)(t).getTime()}},11699:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(59910),a=n(13882),l=n(93645);function o(e,t,n){(0,a.Z)(2,arguments);var o=(0,r.Z)(e,t)/1e3;return(0,l.u)(null==n?void 0:n.roundingMethod)(o)}},19013:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(71002),a=n(13882);function l(e){(0,a.Z)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===(0,r.Z)(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):(("string"==typeof e||"[object String]"===t)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(Error().stack)),new Date(NaN))}},54005:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/actions",function(){return n(91257)}])},49947:function(e,t,n){"use strict";var r=n(82215),a=n(63085),l=r.ZP;l.Header=r.h4,l.Footer=r.$_,l.Content=r.VY,l.Sider=a.Z,l._InternalSiderContext=a.D,t.default=l},91257:function(e,t,n){"use strict";n.r(t);var r=n(85893),a=n(47271),l=n(24716),o=n(90163),i=n(35386),u=n(43795),s=n(43883),c=n(96652),d=n(90622),h=n(43796),p=n(95089),f=n(58909),m=n(82261),x=n(5152),g=n.n(x),j=n(67294),y=n(65326),v=n(53068),b=n(70329),w=n(84443),k=n(94956),C=n(695);let{Title:S,Paragraph:I}=a.default,Z=g()(()=>Promise.all([n.e(7298),n.e(7618)]).then(n.t.bind(n,7618,23)),{loadableGenerated:{webpack:()=>[7618]},ssr:!1}),E=g()(()=>Promise.all([n.e(7298),n.e(1460)]).then(n.t.bind(n,51460,23)),{loadableGenerated:{webpack:()=>[51460]},ssr:!1}),T=e=>{let{onOk:t,onCancel:n,open:a,action:c}=e,[d,h]=(0,j.useState)("url"),[x,g]=(0,j.useState)(""),[y,v]=(0,j.useState)(""),[b,w]=(0,j.useState)(""),[C,S]=(0,j.useState)(""),[I,Z]=(0,j.useState)(""),[E,T]=(0,j.useState)(""),[_,O]=(0,j.useState)(!1);(0,j.useEffect)(()=>{var e;h(((null==c?void 0:null===(e=c.html)||void 0===e?void 0:e.length)||0)>0?"html":"url"),g((null==c?void 0:c.url)||""),v((null==c?void 0:c.html)||""),w((null==c?void 0:c.title)||""),S((null==c?void 0:c.description)||""),Z((null==c?void 0:c.icon)||""),T((null==c?void 0:c.color)||""),O((null==c?void 0:c.openExternally)||!1)},[c]);let N={disabled:!("html"===d?""!==y&&""!==b:(0,k.jv)(x,["https:"])&&""!==b)};return(0,r.jsx)(l.default,{destroyOnClose:!0,title:null==c?"Create New Action":"Edit Action",open:a,onOk:function(){t(c,e.index,"html"===d?"":x,"html"===d?y:"",b,C,I,E,_),g(""),v(""),w(""),S(""),Z(""),T(""),O(!1)},onCancel:n,okButtonProps:N,children:(0,r.jsxs)(o.default,{initialValues:c,children:["Add the URL for the external action you want to present."," ",(0,r.jsx)("strong",{children:"Only HTTPS URLs and embeds are supported."}),(0,r.jsx)("p",{children:(0,r.jsx)("a",{href:"https://owncast.online/thirdparty/actions/",target:"_blank",rel:"noopener noreferrer",children:"Read more about external actions."})}),(0,r.jsx)(o.default.Item,{children:(0,r.jsx)(i.default,{value:d,onChange:h,placeholder:"Select an action type",options:[{label:"Link or embed an URL",value:"url"},{label:"Custom HTML",value:"html"}]})}),"html"===d?(0,r.jsx)(o.default.Item,{name:"html",children:(0,r.jsx)(p.ZP,{value:y,placeholder:"HTML embed code (required)",theme:f.FZ,height:"200px",extensions:[(0,m.html)()],onChange:e=>{v(e)}})}):(0,r.jsx)(o.default.Item,{name:"url",children:(0,r.jsx)(u.default,{required:!0,placeholder:"https://myserver.com/action (required)",onChange:e=>g(e.currentTarget.value.trim()),type:"url",pattern:k.ax})}),(0,r.jsx)(o.default.Item,{name:"title",children:(0,r.jsx)(u.default,{value:b,required:!0,placeholder:"Your action title (required)",onChange:e=>w(e.currentTarget.value)})}),(0,r.jsx)(o.default.Item,{name:"description",children:(0,r.jsx)(u.default,{value:C,placeholder:"Optional description",onChange:e=>S(e.currentTarget.value)})}),(0,r.jsx)(o.default.Item,{name:"icon",children:(0,r.jsx)(u.default,{value:I,placeholder:"https://myserver.com/action/icon.png (optional)",onChange:e=>Z(e.currentTarget.value)})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(o.default.Item,{name:"color",style:{marginBottom:"0px"},children:(0,r.jsx)(u.default,{type:"color",value:E,onChange:e=>T(e.currentTarget.value)})}),"Optional background color of the action button."]}),"html"===d?null:(0,r.jsx)(o.default.Item,{name:"openExternally",children:(0,r.jsx)(s.Z,{checked:_,defaultChecked:_,onChange:e=>{O(e.target.checked)},children:"Open in a new tab instead of within your page."})})]})})},_=()=>{let{serverConfig:e,setFieldInConfigState:t}=(0,j.useContext)(w.a)||{},{externalActions:n}=e,[a,l]=(0,j.useState)(null),[o,i]=(0,j.useState)(!1),[u,s]=(0,j.useState)(null),[p,f]=(0,j.useState)(null),[m,x]=(0,j.useState)(-1),g=()=>{s(null),clearTimeout(null)};async function k(e){await (0,v.Si)({apiPath:v.os,data:{value:e},onSuccess:()=>{t({fieldName:"externalActions",value:e,path:""}),s((0,b.kg)(b.zv,"Updated.")),setTimeout(g,v.sI)},onError:e=>{console.log(e),s((0,b.kg)(b.Un,e)),setTimeout(g,v.sI)}})}async function C(e){let t=[...a];t.splice(e,1);try{l(t),k(t)}catch(e){console.error(e)}}async function _(e,t,n,r,o,i,u,s,c){try{let e=[...a],d={url:n,html:r,title:o,description:i,icon:u,color:s,openExternally:c};t>=0?e[t]=d:e.push(d),l(e),await k(e)}catch(e){console.error(e)}}async function O(e,t){x(t),f(e),i(!0)}(0,j.useEffect)(()=>{l(n||[])},[n]);let N=[{title:"",key:"delete-edit",render:(e,t,n)=>(0,r.jsxs)(c.Z,{size:"middle",children:[(0,r.jsx)(d.Z,{onClick:()=>C(n),icon:(0,r.jsx)(Z,{})}),(0,r.jsx)(d.Z,{onClick:()=>O(t,n),icon:(0,r.jsx)(E,{})})]})},{title:"Name",dataIndex:"title",key:"title"},{title:"Description",dataIndex:"description",key:"description"},{title:"URL / Embed",key:"url",dataIndex:"url",render:(e,t)=>t.html?"HTML embed":t.url},{title:"Icon",dataIndex:"icon",key:"icon",render:e=>e?(0,r.jsx)("img",{style:{width:"2vw"},src:e,alt:""}):null},{title:"Color",dataIndex:"color",key:"color",render:e=>e?(0,r.jsx)("div",{style:{backgroundColor:e,height:"30px"},children:e}):null},{title:"Opens",key:"openExternally",dataIndex:"openExternally",render:(e,t)=>!e||t.html?"In the same tab":"In a new tab"}];return(0,r.jsxs)("div",{children:[(0,r.jsx)(S,{children:"External Actions"}),(0,r.jsx)(I,{children:"External action URLs are 3rd party UI you can display, embedded, into your Owncast page when a user clicks on a button to launch your action."}),(0,r.jsxs)(I,{children:["Read more about how to use actions, with examples, at"," ",(0,r.jsx)("a",{href:"https://owncast.online/thirdparty/?source=admin",target:"_blank",rel:"noopener noreferrer",children:"our documentation"}),"."]}),(0,r.jsx)(h.Z,{rowKey:e=>"".concat(e.title,"-").concat(e.url),columns:N,dataSource:a,pagination:!1}),(0,r.jsx)("br",{}),(0,r.jsx)(d.Z,{type:"primary",onClick:()=>{f(null),x(-1),i(!0)},children:"Create New Action"}),(0,r.jsx)(y.E,{status:u}),(0,r.jsx)(T,{action:p,index:m,open:o,onOk:(e,t,n,r,a,l,o,u,s)=>{i(!1),_(e,t,n,r,a,l,o,u,s),f(null),x(-1)},onCancel:()=>{i(!1)}})]})};_.getLayout=function(e){return(0,r.jsx)(C.l,{page:e})},t.default=_},11163:function(e,t,n){e.exports=n(73035)}},function(e){e.O(0,[5762,6410,8768,5414,6906,7406,4716,2862,5063,7271,811,5386,9974,8625,3796,9256,695,2888,9774,179],function(){return e(e.s=54005)}),_N_E=e.O()}]);